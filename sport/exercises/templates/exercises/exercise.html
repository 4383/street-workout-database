{% extends "common/base.html" %}
{% load i18n %}
{% load staticfiles %}
{% load static %}
{% get_media_prefix as MEDIA_PREFIX %}
{% load exercises_tags %}

{% block title %}{{ exercise|capfirst }} {% trans "Exercise" %}{% endblock %}
{% block meta_description %}{{ exercise.common_page_attribute.description }}{% endblock %}
{% block meta_keywords %}{{ exercise.common_page_attribute.keywords }}{% endblock %}

{% block main_menu_exercises_active %}
<li class="dropdown active">
{% endblock %}

{% block content %}
    {% comment %}
    <ol class="breadcrumb">
        <li><a href="{% url 'exercises_categories' %}">{% trans "Categories" %}</a></li>
        <li>{{ category|capfirst }}</li>
        <li class="active">{% trans "Description" %}</li>
    </ol>
    {% endcomment %}
    <h1>{{ exercise|capfirst }} <span class="label label-{{ exercise.level }}">{{ exercise.level }}</span></h1>

    {% comment %}{% show_exercises_category_menu category "description" %}{% endcomment %}



    {% if main_exercise_set %}
        {% for set in main_exercise_set %}
            {% if forloop.first %}
            <div class="margin col-md-3 right border-left-gray">
                <h3 class="text-center underline padding-bottom-xl">{% trans "How to do a" %} {{ exercise }} ?</h3>
            {% endif %}
                {% if not forloop.last %}
                    <div class="row margin-bottom-xs border-bottom-gray grid"
                         style="background-image: url('{% get_media_prefix %}{{ set.step.image }}');
                                background-repeat: no-repeat;
                                background-size: 100% 100%;
                                background-position: center;">
                {% else %}
                    <div class="row margin-bottom-xs"
                         style="background-image: url('{% get_media_prefix %}{{ set.step.image }}');
                                background-repeat: no-repeat;
                                background-size: 100% 100%;
                                background-position: center;">
                {% endif %}
                    <div class="col-md-3 medium">
                        <svg>
                            <circle
                                    cx="25"
                                    cy="25"
                                    r="20"
                                    stroke="gray"
                                    stroke-width="1"
                                    fill="{% cycle "#FF0200" "#FF3600" "#FE7500" "#FFAE00" "#FEE000" "#F4FF00" "#BCFE00" "#7FFF00" %}" />
                            <text x="17" y="35" font-size="30" fill="black" >{{ forloop.counter }}</text>
                        </svg>
                    </div>
                    <div class="col-sm-9 text-center">
                        <a class="btn btn-default show-step-description"
                           role="button" data-toggle="collapse" href="#collapseDescription{{ forloop.counter0 }}"
                           aria-expanded="false" aria-controls="collapseDescription{{ forloop.counter0 }}"
                           id="collapseStepBtn{{ forloop.counter0 }}">
                            <span id="collapseStepBtnSpan{{ forloop.counter0 }}"
                                  class="glyphicon glyphicon-resize-full"></span>
                        </a>
                    </div>
                </div>
                <div id="collapseDescription{{ forloop.counter0 }}" class="collapse">
                    <div class="well text-justify">
                        <h5><strong>{{ set.step.name }}</strong></h5>
                        <p>{{ set.step.description }}</p>
                    </div>
                </div>
            {% if forloop.last %}
                </div>
            {% endif %}
            <script>
                $(".show-step-description").click(function(event){
                    var id = event.target.id.substr(event.target.id.length - 1);
                    var class_type = "glyphicon glyphicon-resize-small";
                    console.log("#collapseDescription" + id);
                    console.log($("#collapseDescription" + id).attr("class"));
                    if ("collapse in" == $("#collapseDescription" + id).attr("class")) {
                        class_type = "glyphicon glyphicon-resize-full";
                    }
                    $("#collapseStepBtnSpan" + id).attr("class", class_type);
                });
            </script>
        {% endfor %}
    {% endif %}

    {% show_muscles_mapping exercise %}

    {% comment %}{% if main_image %}
        <section class="right right-spaced-xl panel panel-default padding-xl left-spaced-xl" id="media">
            <img class="img-xl"
                 src="{% get_media_prefix %}{{ main_image.image }}"
                 alt="{{ main_image.alt }}"
                 title="{{ main_image.name }}" />
        </section>
    {% endif %}{% endcomment %}

    <section id="description">
        <p class="text-justify text-xl">{{ exercise.description|capfirst }}</p>
    </section>

    {% if exercise.related_exercise.all %}
        <hr>
        <section id="related-exercise">
            <h4><u>{% trans "Related Exercises" %}</u></h4>
            {% for related_exercise in exercise.related_exercise.all %}
                <a href="{% url 'exercises_exercise' slug=related_exercise.slug %}"
                class="btn btn-success">{{ related_exercise|capfirst }}</a>
            {% endfor %}
        </section>
    {% endif %}
{% endblock %}<!-- End Content -->